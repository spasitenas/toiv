### Основные элементы стенда WBdemo-kit v.2:

1. **Датчики температуры 1-wire DS18B20** (поз. 1 и 2) – используются для измерения температуры.
2. **Преобразователь 1-Wire — Modbus RTU WB-M1W2** (поз. 3) – устройство для подключения датчиков температуры по интерфейсу 1-Wire к сети Modbus RTU.
3. **Устройство ИК-управления WB-MIR** (поз. 4) – инфракрасный контроллер для управления ИК-совместимыми устройствами.
4. **Настенный комбинированный датчик WB-MSW v.3** (поз. 5) – датчик, измеряющий температуру, влажность, уровень освещения, концентрацию CO2 и движение.
5. **RGB лента в профиле** (поз. 6) – светодиодная лента для демонстрации управления освещением.
6. **Блок питания HDR-30-24** (поз. 7) – источник питания на 24 В для устройств стенда.
7. **Контроллер Wiren Board** (поз. 8) – центральный элемент системы автоматизации, который управляет подключёнными устройствами и датчиками.
8. **Модуль ввода-вывода WBIO-DO-R10A-8** (поз. 9) – модуль с релейными выходами для управления нагрузками.
9. **Модуль обнаружения протечек WB-MWAC** (поз. 10) – устройство для обнаружения утечек воды.
10. **Диммер светодиодных лент на DIN-рейку WB-MRGBW-D** (поз. 11) – диммер для управления яркостью и цветом светодиодных RGBW лент.
11. **Комбинированный датчик WB-MS** (поз. 12) – многофункциональный датчик, измеряющий температуру, влажность, освещённость и движение.
12. **Электросчётчик "Милур 307"** (поз. 13) – счётчик электроэнергии.
13. **Автомат питания набора (L1)** (поз. 14), **Автомат питания вентилятора (L2)** (поз. 15), **Автомат питания контактора (L3)** (поз. 16) – автоматические выключатели для подачи и защиты питания различных элементов стенда.
14. **Трансформаторы тока 25 А** (поз. 17-19) – датчики для измерения силы тока.
15. **Контактор 220 В** (поз. 20) – устройство для коммутации высоковольтных цепей.
16. **Модуль реле 3-канальный WB-MR3** (поз. 21) – модуль для управления нагрузками через реле.
17. **Многоканальный измеритель WB-MAP12H** (поз. 22) – устройство для измерения параметров электросети.
18. **Датчик протечки** (поз. 23) – устройство для обнаружения утечек воды.
19. **Индикаторы** (поз. 24-26) – сигнальные индикаторы для отображения состояния различных систем.
20. **Кнопки управления** (поз. 27-29) – кнопки для ручного управления различными функциями, такими как подача воды и сброс аварии.
21. **Импульсный счётчик расхода воды** (поз. 30) – устройство для измерения расхода воды.
22. **Шаровой кран с электроприводом** (поз. 31) – клапан для управления подачей воды.
23. **Вентилятор** (поз. 32) – устройство для демонстрации управления вентиляцией.

### Глобальные и локальные контроллеры:

- **Глобальные контроллеры** – это центральные устройства, которые управляют всей системой автоматизации или несколькими локальными системами. Они обрабатывают данные от датчиков и устройств, принимают решения и отправляют команды на исполнительные устройства. Примером глобального контроллера является **контроллер Wiren Board** (поз. 8), который координирует работу всех элементов стенда.

- **Локальные контроллеры** – это устройства, которые управляют отдельными подсистемами или отдельными устройствами. Например, локальные контроллеры могут управлять освещением, климатом или другими мелкими

### Примеры глобальных и локальных контроллеров на базе **Wiren Board**:

#### 1. **Глобальные контроллеры Wiren Board**:

Глобальные контроллеры отвечают за управление всей системой автоматизации, координацию работы между локальными контроллерами и сбор данных. Они могут управлять большой инфраструктурой, обрабатывая информацию с разных датчиков и подключённых устройств.

##### Примеры:
- **Контроллер Wiren Board 6** (поз. 8 в таблице):
  - Это универсальный контроллер, который используется для управления процессами в умном доме, на производстве или в других системах автоматизации. Он поддерживает множество интерфейсов (Modbus, 1-Wire, MQTT и другие), что позволяет ему взаимодействовать с различными устройствами и системами.
  - В роли глобального контроллера он может координировать работу локальных контроллеров, собирать данные от датчиков, управлять освещением, климатическими системами, безопасностью и т.д.
  
- **Wiren Board 7**:
  - Новая версия контроллера, используется как центральный элемент системы автоматизации. Он может управлять процессами в умном доме, автоматизации зданий, промышленности и других системах, требующих централизованного контроля.
  - Работает с разными протоколами (Modbus, MQTT, Zigbee и т.д.), что позволяет интегрировать различные устройства в систему.

#### 2. **Локальные контроллеры Wiren Board**:

Локальные контроллеры управляют отдельными подсистемами или устройствами и обычно работают на определённой ограниченной области или функциональности (например, управление освещением, климатом или безопасностью). Эти устройства могут работать автономно или под управлением глобального контроллера.

##### Примеры:
- **Модуль реле WB-MR3** (поз. 21 в таблице):
  - Это локальный контроллер, который используется для управления электрическими нагрузками (освещение, электроприводы и т.д.). Он поддерживает интерфейс Modbus RTU и может работать с глобальным контроллером, но также способен выполнять задачи самостоятельно.
  - В системе автоматизации может отвечать за управление освещением или бытовыми приборами в определённой зоне.

- **Модуль ввода-вывода WBIO-DO-R10A-8** (поз. 9 в таблице):
  - Этот модуль может быть использован как локальный контроллер для управления релейными выходами. Он позволяет подключать и управлять различными устройствами и механизмами, такими как электроприборы или двигатели.
  
- **Модуль обнаружения протечек WB-MWAC** (поз. 10 в таблице):
  - Работает как локальный контроллер для мониторинга утечек воды. В случае обнаружения утечки может сразу же отправить сигнал на глобальный контроллер или автономно перекрыть водоснабжение через шаровой кран с электроприводом.
  
- **Устройство ИК-управления WB-MIR** (поз. 4 в таблице):
  - Локальный контроллер для управления устройствами через инфракрасные команды (например, телевизоры, кондиционеры и другие ИК-совместимые устройства). Он может работать независимо или под управлением глобального контроллера Wiren Board.

#### Итого:
- **Глобальные контроллеры** (например, Wiren Board 6 или 7) координируют работу всей системы автоматизации, собирают данные и управляют подключёнными устройствами.
- **Локальные контроллеры** (например, WB-MR3, WB-MWAC) управляют конкретными функциями и устройствами в рамках системы, обеспечивая автономное или интегрированное управление в зависимости от настроек.

Контроллеры WirenBoard — это мощные и гибкие устройства, которые используются для автоматизации, мониторинга и управления в различных системах "умного дома", промышленной автоматизации и IoT-солюциях. Они обеспечивают централизованное управление разнообразными устройствами и датчиками. Вот основные принципы работы контроллеров в системе WirenBoard:

### Основные Компоненты и Принципы Работы

1. **Аппаратная Платформа:**
   - **Процессор и ОС:** Контроллеры WirenBoard основаны на ARM-процессорах и работают под управлением Linux (Debian), что делает их похожими на маленькие компьютеры с широкими возможностями программирования.
   - **Модульность:** Контроллеры могут быть расширены с помощью различных модулей ввода/вывода (WBIO), которые подключаются через специальные интерфейсы.

2. **Интерфейсы Связи:**
   - **Wired Connections:** Ethernet, RS-485, RS-232, 1-Wire, I2C, и Modbus для подключения различных датчиков и устройств.
   - **Wireless Connections:** Wi-Fi, ZigBee (через дополнительные модули), Bluetooth и другие технологии для беспроводного подключения.
   - **MQTT Protocol:** Использование MQTT для обмена сообщениями между устройствами и серверами, что позволяет легко интегрировать контроллер в различные системы IoT.

3. **Программирование и Конфигурация:**
   - **Rule Engine:** Встроенный движок правил позволяет создавать скрипты на языке, основанном на JavaScript, для автоматизации реакций на события в системе.
   - **Пользовательские Скрипты:** Поддержка Python, Bash и других языков позволяет писать сложные скрипты для управления логикой работы контроллера.

4. **Управление Устройствами:**
   - **Датчики и Актуаторы:** Контроллер может собирать данные с температурных датчиков, датчиков влажности, детекторов движения и других, а также управлять освещением, отоплением, системами вентиляции и другими актуаторами.
   - **Modbus Devices:** Широкая поддержка устройств Modbus RTU/TCP позволяет интегрировать в систему промышленное оборудование.

5. **Веб-Интерфейс и API:**
   - **Web Interface:** Пользовательский интерфейс на базе веб-технологий для настройки, мониторинга и управления контроллером через браузер.
   - **REST API:** Возможность удалённого управления и интеграции с другими системами через RESTful API.

6. **Безопасность:**
   - **Сетевая безопасность:** Возможности настройки firewall, VPN и других технологий для защиты данных и управления доступом.
   - **Обновления и Резервное Копирование:** Регулярные обновления ПО для устранения уязвимостей и функции резервного копирования для восстановления системы.

### Пример Работы Контроллера

Допустим, вам нужно автоматизировать систему умного освещения на базе WirenBoard:

1. **Подключение Устройств:**
   - Подключите светильники к реле-модулям WirenBoard.
   - Добавьте датчики движения через интерфейс 1-Wire или Modbus, в зависимости от модели.

2. **Настройка Логики:**
   - Используя Web UI, перейдите к разделу "Rules" или напишите скрипт на Python.
   - Создайте правило, которое включает свет, если датчик движения активирован и если текущее время находится в заданном диапазоне (например, с 18:00 до 23:00).

3. **Интеграция и Управление:**
   - Если система должна быть интегрирована с внешними сервисами, настройте MQTT-брокера или REST API для отправки команд и получения статусов.
   - Мониторьте состояние системы через Web UI или через внешние системы умного дома.

Эта модель работы показывает, как контроллеры WirenBoard могут быть центром автоматизации, собирая данные от датчиков, принимая решения на основе пользовательских скриптов и управляя физическими устройствами для создания интеллектуальных и эффективных систем.

Датчик температуры DS18B20 является популярным и широко используемым датчиком для измерения температуры в электронных проектах, в том числе в системах на базе WirenBoard. Он использует интерфейс 1-Wire, который позволяет подключать множество таких датчиков к одному микроконтроллеру по одному проводу для передачи данных (плюс провода питания и земли).

### Физическое Устройство и Принцип Работы DS18B20

1. **Конструкция и Основные Характеристики:**
   - **Корпус:** DS18B20 обычно поставляется в трёхвыводном корпусе TO-92, но также может быть в водонепроницаемом исполнении с кабелем и зондом.
   - **Питание:** Работает от 3.0 В до 5.5 В, что делает его совместимым с большинством логических уровней микроконтроллеров.
   - **Температурный диапазон:** От -55°C до +125°C с точностью ±0.5°C в диапазоне от -10°C до +85°C.

2. **Интерфейс 1-Wire:**
   - **Однопроводный Интерфейс:** Позволяет датчику передавать данные по одному проводу (DQ), кроме проводов для питания (VDD) и земли (GND).
   - **Адресация:** Каждый DS18B20 имеет уникальный 64-битный серийный код, позволяющий работать с множеством датчиков на одной шине 1-Wire.
   - **Коммуникация:** Чтобы общаться с микроконтроллером, датчик использует специфические временные интервалы для передачи и приёма битов (присутствие импульса).

3. **Принцип Работы:**
   - **Инициализация:** Микроконтроллер инициирует сессию, отправляя "сброс" и получая "присутствие" от датчика, что является подтверждением его готовности к работе.
   - **Команды:** Микроконтроллер отправляет команды для чтения температуры, записи настроек или чтения серийного номера.
   - **Измерение Температуры:** По команде `CONVERT_T`, DS18B20 проводит измерение температуры и сохраняет результат в своём внутреннем регистре.
   - **Передача Данных:** По команде `READ_SCRATCHPAD`, датчик передаёт содержимое своих регистров (включая температуру) обратно в микроконтроллер.

4. **Преобразование Данных:**
   - **Формат Данных:** Температура измеряется в 12-битном формате с дополнительным кодом и передаётся в двух байтах: младший и старший.
   - **Вычисление Температуры:**
     - Прочитайте два байта данных из датчика.
     - Сформируйте 16-битное значение: \( \text{TEMP} = \text{MSB} \times 256 + \text{LSB} \).
     - Если измеряемая температура положительная, то \( T = \frac{\text{TEMP} \times 0.0625}{16} \).
     - Если температура отрицательная, то используйте дополнительный код для получения температуры: \( T = \left( \text{TEMP} - 65536 \right) \times 0.0625 \).

5. **Паразитное Питание:**
   - DS18B20 может работать в режиме "паразитного питания", когда питание осуществляется через данные и землю, без использования отдельного провода VDD.

### Пример Подключения DS18B20 к WirenBoard

Для подключения DS18B20 к контроллеру WirenBoard:

1. **Подключите VDD к +3.3V или +5V** (в зависимости от вашей конфигурации).
2. **Подключите GND к земле.**
3. **Подключите DQ к одному из GPIO портов, поддерживающих 1-Wire интерфейс.** На контроллере WirenBoard это может быть порт с поддержкой 1-Wire, обозначенный как `1W`.
4. **Установите резистор 4.7кОм между VDD и DQ** для подтяжки данных к питанию (это необходимо для надёжной работы шины 1-Wire).

После физического подключения датчика, вы можете использовать стандартные библиотеки и инструменты WirenBoard для работы с 1-Wire устройствами, чтобы считывать температуру и использовать данные в своих проектах автоматизации.

Преобразователь 1-Wire — Modbus RTU WB-M1W2 от компании WirenBoard — это устройство, которое служит мостом между датчиками, работающими по протоколу 1-Wire, и системами, использующими Modbus RTU для связи. Это позволяет интегрировать датчики температуры (например, DS18B20), а также другие устройства 1-Wire в стандартные промышленные системы на базе Modbus.

### Физическая Работа и Принципы Преобразователя WB-M1W2

#### Основные Характеристики и Функции

1. **Интерфейсы и Подключение:**
   - **1-Wire Interface:** Позволяет подключать до 16 датчиков DS18B20 (или другие устройства 1-Wire) к одному преобразователю.
   - **Modbus RTU Interface:** RS-485 порт для связи с контроллерами и системами, использующими Modbus RTU.

2. **Питание:**
   - Преобразователь WB-M1W2 работает от 9 до 28 В постоянного тока, что делает его подходящим для использования в широком ранге промышленных приложений.

3. **Конструкция:**
   - Устройство выполнено в компактном корпусе, который можно легко монтировать на DIN-рейку в электротехнических шкафах.

#### Принцип Работы

1. **Преобразование Сигналов:**
   - **Считывание Данных с 1-Wire:** WB-M1W2 регулярно опрашивает подключенные датчики 1-Wire, считывая с них данные. Для датчиков температуры DS18B20 это будет текущая температура.
   - **Формирование Данных для Modbus:** Преобразователь конвертирует считанные значения в формат, который может быть передан по шине Modbus RTU. Каждый датчик DS18B20 представлен в виде отдельного регистра в пространстве Modbus устройства.

2. **Протокольное Взаимодействие:**
   - **Modbus RTU:** Устройство функционирует как Modbus-слейв. Контроллер или компьютер (Modbus-мастер) может опрашивать WB-M1W2, используя стандартные функции протокола Modbus RTU, в частности, функцию чтения holding registers.

3. **Обработка и Ответы:**
   - Когда мастер-устройство посылает запрос на чтение к WB-M1W2, преобразователь отвечает, отправляя данные из своих регистров, которые соответствуют текущим значениям температуры от каждого подключенного датчика DS18B20.

4. **Адресация и Конфигурация:**
   - Каждый датчик на шине 1-Wire имеет уникальный серийный номер, но в контексте Modbus данные представляются в виде последовательных регистров.
   - Устройство WB-M1W2 имеет собственный Modbus-адрес, который можно настроить для интеграции в различные системы.

5. **Паразитное Питание:**
   - WB-M1W2 поддерживает паразитное питание для подключенных датчиков 1-Wire, что уменьшает количество необходимых проводов.

### Пример Подключения и Использования WB-M1W2

Для интеграции датчиков температуры DS18B20 в систему управления на базе Modbus RTU с использованием WB-M1W2:

1. **Подключение Датчиков к WB-M1W2:**
   - Подсоедините датчики DS18B20 к клеммам 1-Wire на WB-M1W2.
   - Если используете несколько датчиков, соедините их по шине 1-Wire, обеспечив правильное подключение (DQ, VDD, GND).

2. **Подключение WB-M1W2 к Modbus RTU:**
   - Подключите клеммы RS-485 (A и B) WB-M1W2 к шине Modbus RTU вашей системы.

3. **Конфигурация и Адресация:**
   - Задайте адрес WB-M1W2 и другие параметры Modbus, используя DIP-переключатели или через программное обеспечение, если предусмотрено конструкцией.

4. **Опрос WB-M1W2:**
   - С Modbus-мастера отправляйте запросы чтения holding registers, начиная с адреса, который соответствует первому датчику DS18B20.
   - Преобразователь будет отвечать значениями температуры, преобразованными к формату Modbus (обычно в десятых долях градуса Цельсия).

5. **Обработка Данных:**
   - На стороне системы управления (мастер) обработайте полученные данные, преобразовав их, если нужно, и используйте для дальнейшей логики управления или мониторинга.

Таким образом, WB-M1W2 обеспечивает надёжный и эффективный способ интеграции простых датчиков, таких как DS18B20, в промышленные системы на базе Modbus RTU, расширяя возможности мониторинга и управления без необходимости сложной переписки или изменения основной инфраструктуры системы.

Протокол 1-Wire разработан компанией Dallas Semiconductor (теперь часть Maxim Integrated) и представляет собой систему связи, которая позволяет подключать множество устройств, таких как датчики температуры, серийные EEPROM, часы реального времени и другие компоненты, к микроконтроллеру по одному проводу для передачи данных. Этот провод, в дополнение к земле, является единственным необходимым для обмена данными, хотя некоторые устройства могут также использовать отдельный провод для питания.

### Основные Характеристики Протокола 1-Wire

1. **Однопроводная Шина:**
   - **Минимальное Количество Проводов:** Для работы требуется только один провод (data line), если используется паразитное питание, и два провода (data + ground), если не используется паразитное питание.
   - **Паразитное Питание:** Многие устройства могут получать питание непосредственно от данных линии во время операций чтения и записи, что уменьшает количество проводов до минимума.

2. **Коммуникация и Сетевая Топология:**
   - **Несколько Устройств на Одной Линии:** На одной шине 1-Wire может быть подключено множество устройств, каждое из которых обладает уникальным 64-битным ROM-кодом, который используется для адресации.
   - **Мастер-Слейв:** Шина управляется одним мастером (обычно микроконтроллер), который инициирует все операции с устройствами-слейвами.

3. **Уникальный Идентификатор:**
   - Каждое устройство на шине имеет уникальный 64-битный серийный номер, который включает в себя 8-битный код семейства (тип устройства), 48-битный серийный номер и 8-битную контрольную сумму.

4. **Скорость Обмена и Дальность:**
   - **Скорость:** Обычные скорости передачи данных — от 15.4 кбит/с до 125 кбит/с.
   - **Дальность:** Максимальная длина шины может достигать 100 метров, но это зависит от скорости передачи данных и качества проводника.

### Принципы Работы и Операции Протокола 1-Wire

#### 1. Инициализация Сессии (Reset и Presence Pulse)

1. **Reset Pulse:**
   - Мастер инициирует сессию, отправляя на линию импульс сброса (Reset Pulse) — низкий уровень напряжения на линии в течение минимум 480 микросекунд.

2. **Presence Pulse:**
   - Устройства на линии отвечают на Reset Pulse путём отправки "присутствия" (Presence Pulse) — короткого замыкания линии на низкий уровень на 60-240 микросекунд.

#### 2. Команды и Обмен Данными

1. **Отправка Команд:**
   - **Write 1 Time Slot:** Для записи '1' мастер генерирует очень короткий импульс низкого уровня (1-15 мкс), а затем высокий уровень на оставшуюся часть временного слота (до 60 мкс).
   - **Write 0 Time Slot:** Для записи '0' мастер генерирует более длинный импульс низкого уровня (60 мкс).

2. **Чтение Данных:**
   - Мастер инициирует чтение, выставляя низкий уровень на короткое время (1-15 мкс), затем переводит линию в режим ввода и считывает уровень сигнала.

#### 3. ROM-Команды

1. **Поиск ROM (`0xF0`):** Используется для определения всех устройств на шине.
2. **Чтение ROM (`0x33`):** Читает 64-битный уникальный код одного подключенного устройства.
3. **Совпадение ROM (`0x55`):** Используется для выбора устройства с определённым ROM-кодом для последующей коммуникации.
4. **Пропуск ROM (`0xCC`):** Для отправки команд всем устройствам на шине без адресации (если подключено одно устройство).

#### 4. Пример Работы с Датчиком DS18B20

1. **Инициализация:**
   - Мастер отправляет Reset Pulse.
   - DS18B20 отвечает Presence Pulse.

2. **Чтение Температуры:**
   - Мастер отправляет команду `Skip ROM` (если один датчик) или `Match ROM` (если множество датчиков).
   - Затем мастер отправляет команду `Convert T` (`0x44`), чтобы датчик начал измерение.
   - Мастер ждёт завершения преобразования (DS18B20 выставляет линию в высокий уровень).
   - Мастер отправляет команду `Read Scratchpad` (`0xBE`) для чтения результата измерения.

### Выводы

Протокол 1-Wire — это удобный и эффективный способ подключения маломощных устройств к микроконтроллерам с минимальным количеством проводов. Он идеально подходит для ситуаций, где необходимо собирать данные с большого количества датчиков без сложной проводки.

## Что такое Modbus RTU?

**Modbus RTU** (Remote Terminal Unit) — это один из протоколов серии Modbus, используемый в промышленных системах автоматизации для обмена данными между электронными устройствами. Он является простым, надёжным и широко распространённым протоколом для связи с контроллерами, датчиками, актуаторами и другими устройствами в системах автоматизации и SCADA.

Modbus RTU работает на основе последовательной связи и обеспечивает обмен данными по одной паре проводов (двухпроводной шине RS-485 или RS-232), используя бинарное представление данных.

## Основные Характеристики Modbus RTU

1. **Серийная Коммуникация:** Использует последовательные линии RS-232 или RS-485 для физической передачи данных.
2. **Бинарный Формат:** Данные и команды передаются в бинарном формате, что делает протокол более компактным и быстрым по сравнению с ASCII-версией Modbus.
3. **Мастер-Слейв Архитектура:** Modbus RTU использует мастер-слейв структуру, где один мастер (обычно контроллер) управляет обменом данными с множеством слейвов (устройства).
4. **Адресация:** Поддерживает адресацию до 247 слейв-устройств на одной шине.
5. **Функции Протокола:** Включает функции для чтения и записи регистров и дискретных значений, а также для диагностики и управления.

## Принцип Работы Modbus RTU

### 1. Формат Сообщения

Сообщение Modbus RTU состоит из следующих частей:

- **Адрес Слейва (1 байт):** Указывает, какому устройству предназначено сообщение (0-247).
- **Код Функции (1 байт):** Определяет тип запроса/команды (например, чтение регистров, запись значений).
- **Данные (n байт):** Содержат дополнительные параметры запроса или данные для записи.
- **CRC (2 байта):** Циклический избыточный код, используемый для проверки целостности сообщения.

### 2. Обмен Данными

1. **Инициация Сообщения (Мастер):**
   - Мастер формирует и отправляет сообщение адресованное одному из слейвов.
   - Сообщение содержит адрес слейва, код функции и, при необходимости, данные.

2. **Приём и Обработка (Слейв):**
   - Слейв с соответствующим адресом принимает сообщение.
   - Слейв проверяет CRC сообщения на ошибки.
   - Если сообщение корректно, слейв выполняет запрошенную операцию: чтение или запись данных.

3. **Ответ Слейва:**
   - Слейв формирует ответное сообщение, которое включает адрес слейва, код функции и запрошенные данные или подтверждение выполнения операции.
   - Слейв отправляет ответ мастеру.

### 3. Типы Операций

Modbus RTU поддерживает различные функции для обмена данными:

- **Функции Чтения:**
  - `0x03` (Read Holding Registers): Чтение ряда регистров хранения.
  - `0x04` (Read Input Registers): Чтение ряда входных регистров.
  - `0x01` (Read Coils): Чтение ряда реле (coils).
  - `0x02` (Read Discrete Inputs): Чтение ряда дискретных входов.

- **Функции Записи:**
  - `0x05` (Write Single Coil): Запись одного реле.
  - `0x06` (Write Single Register): Запись одного регистра хранения.
  - `0x0F` (Write Multiple Coils): Запись нескольких реле.
  - `0x10` (Write Multiple Registers): Запись нескольких регистров хранения.

- **Диагностика и Управление:**
  - `0x08` (Diagnostic): Диагностика.
  - `0x11` (Report Slave ID): Возврат идентификатора слейва.
  - `0x16` (Mask Write Register): Маскированная запись регистра.

### 4. Тайминги и Ошибки

- **Таймауты:** Если слейв не ответил в установленное время, мастер может повторить запрос или выдать ошибку.
- **Обработка Ошибок:** Если слейв обнаруживает ошибку в запросе (неподдерживаемая функция, неверный адрес данных), он возвращает сообщение об ошибке с соответствующим кодом.

### 5. Пример Обмена

1. **Мастер Запрашивает Данные:**
   - Мастер отправляет запрос на чтение (`0x03`) 10 регистров хранения начиная с адреса `0x0001` слейву с адресом `0x01`.
   - Формат сообщения: `[01][03][00][01][00][0A][CRC]`.

2. **Слейв Отвечает:**
   - Слейв `0x01` принимает запрос, проверяет CRC и читает 10 регистров.
   - Ответ: `[01][03][14][Data...][CRC]`, где `[14]` - количество байт данных, следующих за этим кодом.

### Вывод

Modbus RTU — это эффективный и надёжный протокол для промышленной автоматизации, который обеспечивает простую и структурированную систему для обмена данными между устройствами в сети. Его простота и широкая поддержка делают его идеальным выбором для многих приложений в области автоматизации.

### RS-232 и RS-485: Основы Последовательных Линий

**RS-232** и **RS-485** являются стандартами последовательной связи, которые определяют электрические характеристики и протоколы для обмена данными между электронными устройствами. Они используются во многих промышленных, телекоммуникационных и компьютерных системах для передачи данных на короткие и средние расстояния.

#### RS-232 (Recommended Standard 232)

**RS-232** — это стандарт для последовательной двунаправленной точка-точка связи между двумя устройствами. Этот стандарт был введён в 1960-х годах.

##### Основные Характеристики RS-232:

1. **Тип Соединения:**
   - Последовательное соединение, обычно точка-точка (один передатчик и один приёмник).
   
2. **Количество Устройств:**
   - Стандартный RS-232 поддерживает соединение только 2 устройств (DTE и DCE).

3. **Разъёмы и Кабели:**
   - Часто используются разъёмы DB-9 (9-пиновый) и DB-25 (25-пиновый).
   - Кабель обычно содержит одну линию для передачи данных (TxD), одну для приёма данных (RxD), и одну земляную линию (GND).

4. **Электрические Сигналы:**
   - Используются напряжения от +3 до +15 вольт для логического 0 и от -3 до -15 вольт для логической 1.
   - Напряжения в диапазоне от -3V до +3V считаются неопределёнными.

5. **Дальность и Скорость:**
   - Максимальная скорость передачи данных составляет около 20 кбит/с на расстояниях до 15 метров.
   - Скорость передачи и дальность обратно пропорциональны: увеличение дальности ведёт к снижению скорости.

6. **Применение:**
   - Подключение компьютеров к модемам, принтерам, данным и тестовым устройствам.

##### Пример Соединения RS-232:

```
Компьютер (DTE) <-----> (DCE) Модем
     |                             |
    TxD --------------------- RxD
    RxD --------------------- TxD
    GND --------------------- GND
```

#### RS-485 (Recommended Standard 485)

**RS-485** — это стандарт для последовательной связи, предназначенный для обеспечения высокоскоростной передачи данных в многоточечных системах.

##### Основные Характеристики RS-485:

1. **Тип Соединения:**
   - Дифференциальная передача данных, позволяющая подключать до 32 устройств в одной сети (32 устройства-передатчика и 32 устройства-приёмника).

2. **Дифференциальные Сигналы:**
   - Использует пару проводов для каждого сигнала (A и B) для улучшения устойчивости к электромагнитным помехам.
   - Сигнал определяется разностью напряжений между двумя проводами: \( V_{AB} = V_A - V_B \).

3. **Разъёмы и Кабели:**
   - Часто используются витая пара и разъёмы типа DB-9 или клеммные блоки.

4. **Электрические Сигналы:**
   - Напряжение на каждом из линий относительно земли может быть от -7V до +12V, но важна разность напряжений между A и B, которая должна быть в пределах 1.5V для логической 1 и -1.5V для логической 0.

5. **Дальность и Скорость:**
   - Максимальная скорость передачи данных может достигать 10 Мбит/с на коротких расстояниях (до 12 метров).
   - Может передавать данные на расстояния до 1200 метров при скорости 100 кбит/с.

6. **Применение:**
   - Широко используется в промышленных сетях для подключения датчиков, метеостанций, систем управления и мониторинга.

##### Пример Сети RS-485:

```
Устройство 1 <-----> Устройство 2 <-----> ... <-----> Устройство N
     |                   |                             |
    A -------------------A------------------- ... -----A
    B -------------------B------------------- ... -----B
    GND -----------------GND----------------- ... ----GND
```

### Сравнение RS-232 и RS-485

- **Топология:** RS-232 используется для точка-точка соединения, в то время как RS-485 поддерживает многоточечные соединения.
- **Дальность:** RS-232 эффективен на коротких дистанциях (до 15 м), RS-485 же работает на расстояниях до 1200 м.
- **Скорость:** RS-485 обеспечивает более высокие скорости передачи данных по сравнению с RS-232.
- **Устойчивость к помехам:** RS-485 с его дифференциальной передачей более устойчив к электромагнитным помехам, чем RS-232.
- **Количество устройств:** RS-485 позволяет подключать до 32 устройств на одной шине, тогда как RS-232 — только 2.

Оба стандарта занимают важное место в индустрии, каждый со своим набором преимуществ для определённых приложений. RS-232 часто используется в настольных и потребительских приложениях, тогда как RS-485 преимущественно применяется в промышленных и распределённых сетевых системах.
